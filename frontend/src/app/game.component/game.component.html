<div class="game-dialog">
  <div class="field-wrap" [style.background]="game.field.mainColor ?? '#eee'">
    <!-- render rows top-to-bottom -->
    @for (y of rows(game.field.height); track y) {
      <div class="row">
        @for (x of cols(game.field.width); track x) {
          <div
            class="cell"
            (click)="onCellClick($event, x, y)"
            [style.background]="((x + y) % 2 === 0 ? (game.field.mainColor ?? '#fff') : (game.field.secondaryColor ?? '#ccc'))"
            role="gridcell"
            aria-rowindex="{{y + 1}}"
            aria-colindex="{{x + 1}}"
          >
            <div class="cell-inner">
              @for (piece of piecesAt(x, y); track piece) {
                <app-piece
                  [piece]="piece"
                  (click)="selectPiece($event, piece)"
                  [class.selected]="isSelected(piece)"
                  (description)="showDescription($event, piece)"
                  [attr.data-piece-id]="piece.id"
                ></app-piece>
              }
            </div>
          </div>
        }
      </div>
    }
  </div>
  <div class="secondary-area">
    <app-secondary-area [game]="game"></app-secondary-area>
  </div>
</div>

@if (pieceDescription) {
  <div
    class="description tooltip"
    role="note"
    [style.left.px]="tooltipLeft"
    [style.bottom.px]="tooltipBottom"
  >
    <!-- render properties as a vertical list -->
    @for (prop of descriptionTooltipProperties; track prop) {
      <div class="prop-row">
        <div class="prop-key">{{ prop.key }}</div>
        <div class="prop-value">{{ prop.value }}</div>
      </div>
    }
  </div>
}
